import { Meta } from '@storybook/blocks'
import { StoryHeading } from '@docs/helpers/StoryHeading'

import ArgstableImg from '@docs/assets/argstable.png'

<Meta title="Build/Build" />

# Build strategy

- [How it works](#how-it-works)
- [Configuration](#configuration)

<StoryHeading label="How it works" />

The build task of each package is managed by Vite. Among other things, Vite offers "A build command that bundles your code with Rollup, pre-configured to output highly optimized static assets for production."

When it is time to deploy your app for production, simply run the `vite build` command.

<StoryHeading label="Configuration" />

Each package must include a `vite.config.ts` that will allow certain configuration about the final result of the artifact. The list of posible configutation can be found in the [Vite documentation website](https://vitejs.dev/config/build-options.html#build-target)

Spark has a base configuration located in the `/config` directory with certain defaults that should be shared between all the packages. Including:

<StoryHeading label="build.target" heading="h3" />

Definition: Browser compatibility target for the final bundle.

[Documentation](https://vitejs.dev/config/build-options.html#build-target)

```json
build.target: 'es2015'
```

<StoryHeading label="build.lib" heading="h3" />

```json
build.lib: {
  entry: 'src/index.ts',
      formats: ['es', 'cjs'],
      fileName: 'index',
}
```

Definition: Build as a library.

- `entry` is required since the library cannot use HTML as entry.
- `name` is the exposed global variable and is required when formats includes 'umd' or 'iife'.
- `formats`: Default formats are ['es', 'umd'], or ['es', 'cjs'], if multiple entries are used.
- `fileName` is the name of the package file output, default fileName is the name option of package.json, it can also be defined as function taking the format and entryAlias as arguments.

[Documentation](https://vitejs.dev/config/build-options.html#build-lib)

```

```
