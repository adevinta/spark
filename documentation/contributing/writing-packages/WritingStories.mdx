import { Meta } from '@storybook/blocks'
import { Callout } from '@docs/helpers/Callout'

import ArgstableImg from '@docs/assets/argstable.png'

<Meta title="Contributing/Writing packages/Documentation" />

# Writing stories

The following guide is showing you how to structure your components documentation.

## Docs VS Stories

Each component must have a `doc` and a `stories` file. For example:

- `MyComponent.doc.mdx`: Main page of documentation for the component. It uses markdown (MDX) syntax for easy documentation.
  - This page gather the component's props and stories
- `MyComponent.stories.tsx`:
  - This file contains every example (story) for your component.
  - It is using the CSF format.

## Docs

### Docs guidelines

- Every Docs file must have the following extension: `*.doc.mdx`.
- You must write the following sections in the same order for every component.

### 1. Referencing the Meta

The meta is the semantic information about the documented component.
It must be located in the `*stories.tsx` file, but must be referenced in this one to link both files.

```
// Radio.doc.mdx

import { Meta } from '@storybook/addon-docs'

import * as RadioStories from './Radio.stories'

<Meta of={RadioStories} />
```

### 2. Install

Add a section to show developers how to install this component on their repository.

````
// Radio.doc.mdx

## Install

\```sh
npm install @spark-ui/radio
\```
````

### 3. Import

Add a section to show developers how to import this component from their repository.

````
// Radio.doc.mdx

## Import

\```ts
import { RadioGroup, Radio } from '@spark-ui/radio'
\```
````

### 4. Props

#### Props for single components

For prop, we rely on `ArgTypes` to read TS files and generate them automatically.

```
// Radio.doc.mdx

import { ArgTypes } from '@storybook/blocks';

import { Radio } from '.'

## Props

<ArgTypes of={Radio} />
```

**Here is what the ArgTypes looks like for a simple component:**

<img width={800} src={ArgstableImg} alt="ArgTypes shows a table of the component's props" />

#### Props for compound components

TODO

### 5. Linking stories

Stories are imported from the associated `*.stories.tsx` file, which is written with CSF format.

`Canvas` is used to allow preview of source code for each story.

<Callout kind="warning">
  Each story should showcase a single prop/feature of your component. **Avoid stories mixing many
  properties at once to keep things simple**.
</Callout>

```
// Radio.doc.mdx

import { Canvas, Story } from '@storybook/addon-docs'

## Default

Compound `RadioGroup` and `Radio` components to create a radio group.

<Canvas>
  <Story of={RadioStories.Default} />
</Canvas>
```

### 6. Accessibility

It is nice to add an `Accessibility` section at the end to summarize keyboard interactions and important a11y requirements of the component.

```
// Radio.doc.mdx

## Accessibility

Adheres to the Radio Group WAI-ARIA design pattern and uses roving tabindex to manage focus movement among radio items.

### Keyboard Interactions

- `Tab`: Moves focus to either the checked radio item or the first radio item in the group.
- `Space`: When focus is on an unchecked radio item, checks it.
- `ArrowDown`: Moves focus and checks the next radio item in the group.
- `ArrowRight`: Moves focus and checks the next radio item in the group.
- `ArrowUp`: Moves focus to the previous radio item in the group.
- `ArrowLeft`: Moves focus to the previous radio item in the group.

```

## Stories

### Guidelines

- Every stories file must have the following extension: `*.stories.tsx`.
- You should write one story per prop. Avoid compolicated stories mixing many props.

### 1. Define the Meta

Component must be using a `Components/*` meta. This meta must be the default export of the file.

Please refer to [official Storybook documentation](https://storybook.js.org/docs/7.0/react/writing-stories/introduction#default-export) to see extra arguments you may be able to use.

```tsx
// Radio.stories.tsx

import { Meta, StoryFn, StoryObj } from '@storybook/react'
import { useState } from 'react'

import { Radio, RadioGroup } from '.'

const meta: Meta<typeof RadioGroup> = {
  title: 'Components/RadioGroup',
  component: RadioGroup,
}

export default meta
```

### 2. Write down your stories

Please refer to [official Storybook documentation](https://storybook.js.org/docs/7.0/react/writing-stories/introduction#defining-stories) to see how you can write stories

<Callout kind="warning">
  Each story must use the `_args` parameter, otherwise the `show source` button of the Canvas will
  show raw js code instead of dynamic JSX.
</Callout>

```tsx
// Radio.stories.tsx

export const Default: StoryFn = _args => (
  <RadioGroup className="flex gap-md">
    <Radio value="1" />
    <Radio value="2" />
    <Radio value="3" />
  </RadioGroup>
)

export const Controlled: StoryFn = _args => {
  const [value, setValue] = useState('1')

  const handleChange = (current: string) => {
    setValue(current)
  }

  return (
    <RadioGroup className="flex gap-md" value={value} onValueChange={handleChange}>
      <Radio value="1" />
      <Radio value="2" />
      <Radio value="3" />
    </RadioGroup>
  )
}

// ...additional stories
```
