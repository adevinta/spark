import { Meta } from '@storybook/blocks'

<Meta title="Contributing/Guidelines/Commit" />

# Commit strategy

- [How it works](#how-it-works)
- [Commit Convention](#commit-convention)
- [Enforcing Convention](#enforcing-convention)
- [Lerna Integration](#lerna-integration)
- [Further reading](#further-reading)

## How it works

- Stage changes `git add .`
- Commit `npm run commit`
  - Select the **type** of change that you're committing
  - Select the **scope** of this change [optional]
  - Write a short, imperative tense description of **the change**
  - Provide a longer description of the change [optional]
  - Select if are there any **breaking changes** (y/N)
  - Select if the change affects any open issues (y/N)

## Commit Convention

Spark âœ¨ adheres to a commit convention called [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0).

Anyone who has upgraded to a new patch version of a dependency, only to watch their application start throwing a steady stream of 500 errors, knows how important a readable commit history (and [ideally a well maintained CHANGELOG](https://keepachangelog.com/en/0.3.0/)) is to the ensuing forensic process.
The Conventional Commits specification proposes introducing a standardized lightweight convention on top of commit messages. This convention dovetails with [SemVer](https://semver.org/), asking software developers to describe in commit messages, features, fixes, and breaking changes that they make.
By introducing this convention, we create a common language that makes it easier to debug issues across project boundaries.

The commit message should be structured as follows:

```
<type>[optional scope]: <description>

[optional body]

[optional footer]
```

In general, the pattern mostly looks like this:
`type(scope?): subject  #scope is optional; multiple scopes are supported (current delimiter options: "/", "\" and ",")`

Checkout [specification docs](https://www.conventionalcommits.org/en/v1.0.0/#specification) for deeper information.

## Enforcing Convention

In order to enforce the convention, [commitlint](https://github.com/conventional-changelog/commitlint) checks if your commit messages meet the conventional commit format using [@commitlint/config-conventional](https://github.com/conventional-changelog/commitlint/tree/master/%40commitlint/config-conventional).

## Lerna Integration

In order to automatically detect and enforce the lerna package and workspace names as scopes, we are using [@commitlint/config-lerna-scopes](https://github.com/conventional-changelog/commitlint/tree/master/@commitlint/config-lerna-scopes)

## Further reading

- [Why Use Conventional Commits?](https://www.conventionalcommits.org/en/v1.0.0/#why-use-conventional-commits)
- ["The perks of committing with conventions" (Talk slides)](https://slides.com/marionebl/the-perks-of-committing-with-conventions)
