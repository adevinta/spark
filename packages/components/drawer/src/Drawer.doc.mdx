import { Meta, Canvas } from '@storybook/blocks'
import { A11yReport } from '@docs/helpers/A11yReport'
import { ArgTypes } from '@docs/helpers/ArgTypes'
import { Kbd } from '@spark-ui/kbd'

import { Drawer } from '.'

import * as stories from './Drawer.stories'

<Meta of={stories} />

# Drawer

A panel that slides out from the edge of the screen. It can be useful when you need users to complete a task or view some details without leaving the current page.

- ✅ Supports modal and non-modal modes.
- ✅ Focus is automatically trapped when modal.
- ✅ Can be controlled or uncontrolled.
- ✅ Manages screen reader announcements with `Title` and `Description` components.
- ✅ Esc closes the component automatically.

## Install

Install the component from your command line.

```sh
npm install @spark-ui/drawer
```

## Import

Import all parts and piece them together.

```tsx
import { Drawer } from '@spark-ui/drawer'
```

## Props

<ArgTypes
  of={Drawer}
  description="Contains all the parts of a drawer."
  subcomponents={{
    'Drawer.Trigger': {
      of: Drawer.Trigger,
      description: 'The button that opens the drawer.',
    },
    'Drawer.Portal': {
      of: Drawer.Portal,
      description: 'When used, portals your overlay and content parts into the body.',
    },
    'Drawer.Overlay': {
      of: Drawer.Overlay,
      description: 'A layer that covers the inert portion of the view when the drawer is open.',
    },
    'Drawer.Content': {
      of: Drawer.Content,
      description: 'Contains Header/Body/Footer to be rendered in the open drawer.',
    },
    'Drawer.Header': {
      of: Drawer.Header,
      description: 'To use inside of Popover.Content. Sticky header inside the drawer.',
    },
    'Drawer.Body': {
      of: Drawer.Body,
      description:
        'To use inside of Popover.Content. Main content of the drawer. Becomes scrollable when content is overflowing the screen.',
    },
    'Drawer.Footer': {
      of: Drawer.Footer,
      description:
        'To use inside of Popover.Content. Sticky footer to be rendered in the open drawer. Use it to render CTAs and make them accessible in every condition.',
    },
    'Drawer.CloseButton': {
      of: Drawer.CloseButton,
      description: 'The button that closes the drawer.',
    },
    'Drawer.Title': {
      of: Drawer.Title,
      description: 'An accessible title to be announced when the drawer is opened.',
    },
    'Drawer.Description': {
      of: Drawer.Description,
      description: 'An optional accessible description to be announced when the drawer is opened.',
    },
  }}
/>

## Usage

### Default

<Canvas of={stories.Usage} />

### Side

Pick a side among `right`, `left`, `top` and `bottom`.

<Canvas of={stories.Side} />

### Size

Pick a size among `sm`, `md`, `lg`, `fluid` and `fullscreen`.

<Canvas of={stories.Sizes} />

### Inset

When set to `true`, this option will remove the internal padding of the `Drawer.Body` component. This allows you to have an image or any content that occupies the full width, for example.

<Canvas of={stories.Inset} />

## Accessibility

<A11yReport of="drawer" />

Adheres to the [Dialog WAI-ARIA design pattern](https://www.w3.org/WAI/ARIA/apg/patterns/dialog-modal/).

### Guidelines

- **Usage of `Drawer.Title` is mandatory**. It serves as the accessible name for the drawer. If you prefer not to display the title, you can wrap it with `VisuallyHidden`.
- **`Drawer.CloseButton` must be rendered as the last child of `Drawer.Content`**. When opening, the drawer forwards the focus to the first interactive element inside of it, it shouldn't be the close button. User can use `Shift + Tab` to easily access the close button after the drawer has been opened.
- Be careful not to overlap content with `Drawer.CloseButton`, which has a large clickable area.

### Keyboard Interactions

- <Kbd>Space</Kbd> - Opens/closes the drawer.
- <Kbd>Enter</Kbd> - Opens/closes the drawer.
- <Kbd>Tab</Kbd> - Moves focus to the next focusable element.
- <Kbd>Shift</Kbd> + <Kbd>Tab</Kbd> - Moves focus to the previous focusable element.
- <Kbd>Esc</Kbd> - Closes the drawer and moves focus to `Drawer.Trigger`.
