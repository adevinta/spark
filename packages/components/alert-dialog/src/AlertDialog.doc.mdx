import { Meta, Canvas } from '@storybook/addon-docs'
import { ArgTypes } from '@docs/helpers/ArgTypes'
import { Kbd } from '@spark-ui/kbd'

import { AlertDialog } from '.'

import * as stories from './AlertDialog.stories'

<Meta of={stories} />

# AlertDialog

A modal dialog that interrupts the user with important content and expects a response.

- Focus is automatically trapped.
- Can be controlled or uncontrolled.
- Manages screen reader announcements with Title and Description components.
- Esc closes the component automatically.

## Install

```sh
npm install @spark-ui/alert-dialog
```

## Import

```tsx
import { AlertDialog } from '@spark-ui/alert-dialog'
```

## Props

<ArgTypes
  of={AlertDialog}
  description="Contains all the parts of an alert dialog."
  subcomponents={{
    'AlertDialog.Trigger': {
      of: AlertDialog.Trigger,
      description: 'A button that opens the dialog.',
    },
    'AlertDialog.Portal': {
      of: AlertDialog.Portal,
      description: 'When used, portals your overlay and content parts into the body.',
    },
    'AlertDialog.Overlay': {
      of: AlertDialog.Overlay,
      description: 'A layer that covers the inert portion of the view when the dialog is open.',
    },
    'AlertDialog.Content': {
      of: AlertDialog.Content,
      description: 'Contains content to be rendered when the dialog is open.',
    },
    'AlertDialog.Header': {
      of: AlertDialog.Header,
      description: 'To use inside of AlertDialog.Content. Sticky header inside the dialog.',
    },
    'AlertDialog.Body': {
      of: AlertDialog.Body,
      description:
        'To use inside of AlertDialog.Content. Main content of the dialog. Becomes scrollable when content is overflowing the screen.',
    },
    'AlertDialog.Footer': {
      of: AlertDialog.Footer,
      description:
        'To use inside of AlertDialog.Content. Sticky footer to be rendered in the open dialog. Use it to render CTAs and make them accessible in every condition.',
    },
    'AlertDialog.Title': {
      of: AlertDialog.Title,
      description: 'An accessible name to be announced when the dialog is opened.',
    },
    'AlertDialog.Description': {
      of: AlertDialog.Description,
      description: 'An accessible description to be announced when the dialog is opened.',
    },
    'AlertDialog.Cancel': {
      of: AlertDialog.Cancel,
      description:
        'A button that closes the dialog. This button should be distinguished visually from AlertDialog.Action buttons.',
    },
    'AlertDialog.Action': {
      of: AlertDialog.Action,
      description:
        'A button that closes the dialog. These buttons should be distinguished visually from the AlertDialog.Cancel button.',
    },
  }}
/>

## Usage

<Canvas of={stories.Usage} />

## Uncontrolled

Use `defaultOpen` prop to set the default state of the dialog. Optionally `onOpenChange` prop can be used to know when the state of the dialog changes.

<Canvas of={stories.Uncontrolled} />

## Controlled

Use `open` and `onOpenChange` props to control the state of the dialog.

<Canvas of={stories.Controlled} />

## Escape

Use `onEscapeKeyDown` prop to listen to when the escape key is pressed. Optionally, the dialog could be prevented from closing by calling `event.preventDefault`.

<Canvas of={stories.Escape} />

## Open focus

Use `onOpenAutoFocus` prop to listen to when focus moves to the less destructive action after opening. Optionally, the autofocus behavior could be prevented by calling `event.preventDefault`.

<Canvas of={stories.OpenFocus} />

## Close focus

Use `onOpenAutoFocus` prop to listen to when focus moves to the trigger after closing. Optionally, the autofocus behavior could be prevented by calling `event.preventDefault`.

<Canvas of={stories.CloseFocus} />

## Accessibility

Adheres to the [Alert and Message Dialogs WAI-ARIA design pattern](https://www.w3.org/WAI/ARIA/apg/patterns/alertdialog).

### Guidelines

- Usage of `Dialog.Title` is **mandatory**. It serves as the accessible name for the dialog. If you prefer not to display the title, you can wrap it with `VisuallyHidden`.

### Keyboard Interactions

- <Kbd>Space</Kbd> - Opens/closes the dialog.
- <Kbd>Enter</Kbd> - Opens/closes the dialog.
- <Kbd>Tab</Kbd> - Moves focus to the next focusable element.
- <Kbd>Shift + Tab</Kbd> - Moves focus to the previous focusable element.
- <Kbd>Esc</Kbd> - Closes the dialog and moves focus to `AlertDialog.Trigger`.
